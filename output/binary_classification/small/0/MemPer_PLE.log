Hyper-parameter search via Optuna
Namespace(task_type='binary_classification', scale='small', idx=0, epochs=1, num_trials=1, num_repeats=1, seed=0, exp_name='MemPer_PLE', result_path='output/binary_classification/small/0/MemPer_PLE.pt')
Device: cuda
Start building binary_classification dataset_small_0
Training set has 26048 instances
Validation set has 3256 instances
Test set has 3257 instances
Bin edges for ['age', 'capital.gain', 'capital.loss', 'hours.per.week']
[tensor([17, 25, 28, 30, 33, 36, 43, 54, 60, 90]), tensor([    0,    57,  3048,  3120,  4243,  4462,  5119,  5316,  7073, 99999]), tensor([   0,   77, 1448, 1568, 1820, 1881, 1978, 2218, 2384, 4356]), tensor([ 1, 34, 39, 41, 49, 65, 99])]
Epoch 1/1 - Train Loss: 0.6204 - Train Metric: 0.5354
Epoch 1/1 - Val Metric: 0.6833
Best val: 0.6833, Best test: 0.6957
Hyper-parameter search done. Found the best config.
Repeat experiments 1 times with the best train config {'batch_size': 256, 'gamma_rate': 1.0, 'base_lr': 0.0001, 'n_bins': 128} and model config {'embed_dim': 8, 'num_layers': 1, 'hidden_dim': 128, 'k': 32}.
Training set has 26048 instances
Validation set has 3256 instances
Test set has 3257 instances
Bin edges for ['age', 'capital.gain', 'capital.loss', 'hours.per.week']
[tensor([17, 25, 29, 33, 36, 43, 54, 61, 90]), tensor([    0,    57,  3048,  3120,  4243,  4826,  5095,  5316,  7073, 99999]), tensor([   0,   77, 1446, 1568, 1820, 1881, 1978, 2168, 2364, 4356]), tensor([ 1, 34, 38, 41, 46, 49, 65, 99])]
Epoch 1/1 - Train Loss: 0.6192 - Train Metric: 0.5653
Epoch 1/1 - Val Metric: 0.7359
Best val: 0.7359, Best test: 0.7380
[0.73797071]
